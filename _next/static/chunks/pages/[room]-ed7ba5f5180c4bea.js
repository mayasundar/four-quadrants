(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{4846:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/[room]",function(){return a(2121)}])},2121:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var l=a(4848),o=a(3368),i=a.n(o),n=a(8005),r=a.n(n),s=a(6540),c=a(5794),d=a.n(c);let u=s.memo(e=>{let{x:t,y:a,value:o,onDelete:i,onDragStop:n,onUpdateText:c,id:u}=e,m=(0,s.useRef)(null),[p,_]=(0,s.useState)(null),h=(0,s.useCallback)((e,t)=>{n(u,t.x,t.y)},[u,n]),x=(0,s.useCallback)(e=>{c(u,e.target.value)},[u,c]);return(0,l.jsx)(d(),{defaultPosition:{x:t,y:a},onStop:h,nodeRef:m,handle:".".concat(r().draggy),children:(0,l.jsxs)("div",{ref:m,className:r().label,onMouseEnter:()=>_(u),onMouseLeave:()=>_(null),children:[(0,l.jsx)("div",{className:r().draggy,children:p===u&&(0,l.jsx)("button",{className:r().deleteButton,onClick:()=>i(u),children:"x"})}),(0,l.jsx)("textarea",{value:o,onChange:x,className:r().labelInput,autoFocus:!0,placeholder:"Enter text",draggable:"false",autoCapitalize:"none",autoCorrect:"off"})]})})}),m=s.memo(e=>{let{circles:t,onAddCircle:a}=e,o=(0,s.useRef)(null),i=(0,s.useMemo)(()=>window.devicePixelRatio,[]),n=(0,s.useMemo)(()=>{let e=Math.floor(600/21),t=Math.floor(600/21),a=600-21*e,l=600-21*t;return{nX:e,nY:t,pL:Math.ceil(a/2)-.5,pT:Math.ceil(l/2)-.5,pR:600-21*e-Math.ceil(a/2)+.5,pB:600-21*t-Math.ceil(l/2)+.5}},[600,21]),{pL:c,pT:d,pR:u,pB:m}=n,p=(0,s.useCallback)(e=>{e.strokeStyle="lightgrey",e.beginPath();for(let t=c;t<=600-u;t+=21)e.moveTo(t,d),e.lineTo(t,600-m);for(let t=d;t<=600-m;t+=21)e.moveTo(c,t),e.lineTo(600-u,t);e.stroke()},[600,c,u,d,m,21]),_=(0,s.useCallback)(e=>{e.strokeStyle="#7F868CFF",e.lineWidth=.5,e.beginPath();let t=21*Math.round(n.nX/2)+c,a=21*Math.round(n.nY/2)+d;e.moveTo(c,a),e.lineTo(600-u,a),e.moveTo(t,d),e.lineTo(t,600-m),e.stroke()},[600,c,u,d,m,21,n]),h=(0,s.useCallback)((e,t,a)=>{e.beginPath(),e.arc(t,a,6,0,2*Math.PI),e.fillStyle="black",e.fill()},[]),x=(0,s.useCallback)(()=>{let e=o.current;if(!e)return;let a=e.getContext("2d");a.clearRect(0,0,e.width,e.height),a.save(),a.scale(i,i),a.translate(.5,.5),a.lineWidth=.5,p(a),_(a),t.forEach(e=>h(a,e.x,e.y)),a.restore()},[t,p,_,h,i]);(0,s.useEffect)(()=>{let e=o.current;e&&(e.style.width="".concat(600,"px"),e.style.height="".concat(600,"px"),e.width=600*i,e.height=600*i,x())},[600,i,x]);let g=(0,s.useCallback)(e=>{let t=o.current;if(!t)return;let l=t.getBoundingClientRect(),i=(e.clientX-l.left)*(600/l.width),n=(e.clientY-l.top)*(600/l.height),r=21*Math.round((i-c)/21)+c,s=21*Math.round((n-d)/21)+d;a({id:Date.now(),x:r,y:s,labelX:r+5,labelY:s+5})},[600,c,d,21,a]);return(0,s.useEffect)(()=>{x()},[t,x]),(0,l.jsx)("canvas",{ref:o,className:r().canvas,onClick:g,style:{position:"absolute",top:0,zIndex:0}})});var p=a(5404);let _=e=>{let{onImagePositionUpdate:t}=e,[a,o]=(0,s.useState)([]),i=(0,s.useRef)(new Map),[n,c]=(0,s.useState)(null),u=e=>{i.current.delete(e),o(t=>t.filter(t=>t.id!==e))},m=(e,t)=>{o(a=>a.map(a=>a.id===e?{...a,size:t}:a))};return(0,l.jsxs)("div",{className:r().imageUpload,children:[(0,l.jsx)("label",{htmlFor:"file-upload",className:r().customFileUpload,children:"Add Image â‡§"}),(0,l.jsx)("input",{id:"file-upload",type:"file",className:r().upload,name:"myImage",onChange:e=>{let t=e.target.files[0];if(t){let e=Date.now();i.current.set(e,s.createRef()),o(a=>[...a,{id:e,file:t,position:{x:0,y:0},size:{width:"50%",height:"min-content"}}])}}}),a.map(e=>(0,l.jsx)(d(),{className:r().imgDrag,position:e.position,nodeRef:i.current.get(e.id),onDrag:(a,l)=>{o(t=>t.map(t=>t.id===e.id?{...t,position:{x:l.x,y:l.y}}:t)),t(e.id,{x:l.x,y:l.y})},children:(0,l.jsxs)("div",{ref:i.current.get(e.id),style:{position:"absolute",zIndex:1,cursor:"grab"},onMouseEnter:()=>c(e.id),onMouseLeave:()=>c(null),onMouseDown:t=>{t.preventDefault();let a=i.current.get(e.id);a.current&&(a.current.style.cursor="grabbing")},onMouseUp:()=>{let t=i.current.get(e.id);t.current&&(t.current.style.cursor="grab")},className:r().uploadedImage,children:[n===e.id&&(0,l.jsx)("button",{className:r().imgDeleteButton,onClick:()=>u(e.id),children:"x"}),(0,l.jsx)(p.c,{size:e.size,lockAspectRatio:!0,onResizeStop:(t,a,l,o)=>{m(e.id,{width:e.size.width+o.width,height:e.size.height+o.height})},children:(0,l.jsx)("img",{className:r().nondrag,alt:"Uploaded",src:URL.createObjectURL(e.file),style:{width:"100%",height:"min-content",objectFit:"contain"}})})]})},e.id))]})};var h=a(6715);function x(e){let{socket:t}=e,a=(0,h.useRouter)(),o=a.query.room,[n,c]=(0,s.useState)({}),[d,p]=(0,s.useState)(null),[x,g]=(0,s.useState)([]),[f,b]=(0,s.useState)([]);(0,s.useEffect)(()=>{if(t&&o)return t.emit("check-name",o),t.on("redirect-name",e=>{a.push("/?room=".concat(e))}),()=>{t.off("redirect-name")}},[t,o]),(0,s.useEffect)(()=>{if(t&&o)return t.emit("get-players",o),t.on("update-players",b),t.on("add-circle",e=>{let{circles:t}=e;g(t)}),t.on("delete-circle",e=>{let{id:t}=e;g(e=>e.filter(e=>e.id!==t))}),t.on("update-circle",e=>{let{id:t,newX:a,newY:l}=e;g(e=>e.map(e=>e.id===t?{...e,labelX:a,labelY:l}:e))}),t.on("update-circle-text",e=>{let{id:t,newText:a}=e;g(e=>e.map(e=>e.id===t?{...e,text:a}:e))}),t.on("update-axis-labels",e=>{let{top:t,left:a,right:l,bottom:o}=e;k({top:t,left:a,right:l,bottom:o})}),()=>{t.off("update-players"),t.off("player-joined"),t.off("add-circle"),t.off("delete-circle"),t.off("update-circle"),t.off("update-circle-text"),t.off("update-axis-labels")}},[t,o]);let v=(0,s.useCallback)(e=>{g(a=>{let l=[...a,{...e,id:Date.now().toString(),text:""}];return t.emit("add-circle",{roomCode:o,circles:l}),l})},[]),y=(0,s.useCallback)(e=>{g(a=>{let l=a.filter(t=>t.id!==e);return t.emit("delete-circle",{roomCode:o,id:e}),l})},[]),j=(0,s.useCallback)((e,a,l)=>{g(i=>{let n=i.map(t=>t.id===e?{...t,labelX:a,labelY:l}:t);return t.emit("update-circle",{roomCode:o,id:e,newX:a,newY:l}),n})},[]),C=(0,s.useCallback)((e,a)=>{g(l=>{let i=l.map(t=>t.id===e?{...t,text:a}:t);return t.emit("update-circle-text",{roomCode:o,id:e,newText:a}),i})},[]),[H,k]=(0,s.useState)({top:"",left:"",right:"",bottom:""}),N=(0,s.useCallback)((e,a)=>{k(t=>({...t,[e]:a})),t.emit("update-axis-labels",{roomCode:o,[e]:a})},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(i(),{children:[(0,l.jsx)("title",{children:"Four Quadrants"}),(0,l.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,l.jsx)("div",{className:r().room,children:(0,l.jsxs)("main",{className:r().main,children:[(0,l.jsxs)("div",{className:r().sidebar,children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{children:"Users"}),(0,l.jsx)("p",{children:f.map((e,t)=>(0,l.jsx)("p",{children:e.name},t))})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{children:"Tools"}),(0,l.jsx)(_,{socket:t,roomCode:o,onImageUpload:e=>{p(URL.createObjectURL(e))},onImagePositionUpdate:(e,t)=>{c(a=>({...a,[e]:t}))},className:r().imageUpload})]})]}),(0,l.jsxs)("div",{className:r().canvasWrapper,children:[(0,l.jsxs)("div",{className:r().axesContainer,children:[(0,l.jsx)("input",{type:"text",className:r().axisLabel,style:{position:"absolute",left:"50%",top:"-45px",transform:"translateX(-50%)"},placeholder:"Enter Text",value:H.top,onChange:e=>N("top",e.target.value)}),(0,l.jsx)("input",{type:"text",className:r().axisLabel,style:{position:"absolute",left:"-140px",top:"50%",transform:"rotate(-90deg) translateY(-50%)"},placeholder:"Enter Text",value:H.left,onChange:e=>N("left",e.target.value)}),(0,l.jsx)("input",{type:"text",className:r().axisLabel,style:{position:"absolute",right:"-140px",top:"50%",transform:"rotate(90deg) translateY(-50%)"},placeholder:"Enter Text",value:H.right,onChange:e=>N("right",e.target.value)}),(0,l.jsx)("input",{type:"text",className:r().axisLabel,style:{position:"absolute",left:"50%",bottom:"-45px",transform:"translateX(-50%)"},placeholder:"Enter Text",value:H.bottom,onChange:e=>N("bottom",e.target.value)})]}),(0,l.jsx)(m,{circles:x,onAddCircle:v,onDeleteCircle:y,onUpdateCircle:j}),(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0},children:x.map(e=>{let t=e.labelX>450?e.labelX-150:e.labelX;return(0,l.jsx)(u,{id:e.id,x:t,y:e.labelY,value:e.text,onUpdateText:C,onDelete:()=>y(e.id),onDragStop:j},e.id)})})]})]})})]})}},8005:e=>{e.exports={room:"Home_room__9KFyW",main:"Home_main__2uIek",sidebar:"Home_sidebar__7e4Eq",form:"Home_form__P1Xey",joinRoomContainer:"Home_joinRoomContainer__9sBMz",q1:"Home_q1__m2vS0",q2:"Home_q2___9kKw",q3:"Home_q3__razJy",q4:"Home_q4__97g4L",grid:"Home_grid__vo_ES",container:"Home_container__9OuOz",flex:"Home_flex__CDpGW",q:"Home_q__L4eGt",stack:"Home_stack__HGtFI",index:"Home_index__gvHS_",customFileUpload:"Home_customFileUpload__070UM",canvas:"Home_canvas__hzON5",canvasWrapper:"Home_canvasWrapper__J_YBx",axesContainer:"Home_axesContainer__D6XP2",axisLabel:"Home_axisLabel__fs9NO",uploadedImage:"Home_uploadedImage__y_OLj",inputfile:"Home_inputfile__zRaeh",nondrag:"Home_nondrag__fXjtb",draggableInput:"Home_draggableInput__aAIDF",label:"Home_label__sorqB",labelInput:"Home_labelInput__OUCm1",draggy:"Home_draggy__tr1DN",deleteButton:"Home_deleteButton___4q3O",imgDrag:"Home_imgDrag__CuKT6",imgDeleteButton:"Home_imgDeleteButton__URyiM",upload:"Home_upload__oOCeL",btn:"Home_btn__gD3FO",maya:"Home_maya__HcYO6",page:"Home_page__z25kN"}}},e=>{var t=t=>e(e.s=t);e.O(0,[536,636,593,792],()=>t(4846)),_N_E=e.O()}]);